package com.datical.hammer.core.forecast


import java.util.Collection;
import java.util.List;
import java.util.Arrays;
import java.util.ArrayList;
import org.apache.commons.lang.StringUtils;
import org.apache.commons.collections.ListUtils;
import com.datical.hammer.core.rules.Response;
import com.datical.hammer.core.rules.Response.ResponseType;
import com.datical.hammer.core.rules.GeneratedSQL;
import com.valic.util.OracleCodeUtilities ;

function boolean fncheckCodehasSelectStar(String myCode) {
com.valic.util.OracleCodeUtilities orclUtil= new com.valic.util.OracleCodeUtilities();
orclUtil.stripOracleComments(myCode).contains("select *") ;
}

dialect "mvel" ;


rule "Generated SQL should not contain Select * "
	salience 91
	when
	     $genSQL :  GeneratedSQL() ;
		eval( fncheckCodehasSelectStar(  $genSQL.outputSQL ) ) ;
	then
		String errorMessage = "The generated SQL contains Wild Select Statement 'Select *'";
		insert(new Response(ResponseType.FAIL, errorMessage, drools.getRule().getName()));
	end
   